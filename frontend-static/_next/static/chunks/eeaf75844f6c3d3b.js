(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,a)=>{t.exports=e.r(76562)},72906,e=>{"use strict";e.s(["default",()=>h],72906),e.i(47167);var t=e.i(43476),a=e.i(71645),r=e.i(18566),i=e.i(46932),s=e.i(11152);let o=[{label:"Usuarios",icon:(0,t.jsx)(s.FaUsers,{}),path:"usuarios"},{label:"Inventario",icon:(0,t.jsx)(s.FaBoxOpen,{}),path:"inventario"},{label:"Reportes",icon:(0,t.jsx)(s.FaFileAlt,{}),path:"reportes"},{label:"Configuración",icon:(0,t.jsx)(s.FaCog,{}),path:"configuracion"},{label:"Recibir lote",icon:(0,t.jsx)(s.FaTruck,{}),path:"lote"},{label:"Cerrar sesión",icon:(0,t.jsx)(s.FaSignOutAlt,{}),path:"logout"}];function n(e){let{active:n,setActive:l}=e,[c,d]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1),x=(0,r.useRouter)();(0,a.useEffect)(()=>{let e=()=>m(window.innerWidth>=1024);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let p=async e=>{if("logout"===e){await fetch("".concat("https://erp.pcmaker.mx","/api/usuarios/logout"),{method:"POST",credentials:"include"}),localStorage.removeItem("email"),x.push("/login");return}l(e),d(!1)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{className:"lg:hidden fixed top-5 left-5 z-40 bg-indigo-600 text-white p-2 rounded-full shadow",onClick:()=>d(!0),children:(0,t.jsx)(s.FaBars,{size:20})}),(0,t.jsxs)(i.motion.aside,{initial:!1,animate:{x:u||c?0:-140},transition:{type:"spring",stiffness:80,delay:.15},className:"\n          fixed top-0 left-0 z-30 h-full w-20 bg-white\n          border-r border-gray-200 shadow-sm py-4 px-4\n          flex flex-col\n          overflow-y-auto\n          ".concat(c?"block":"hidden","  // móvil\n          lg:flex                       // escritorio siempre visible\n        "),style:c&&!u?{boxShadow:"0 0 0 100vmax rgba(0,0,0,0.4)"}:{},children:[(0,t.jsx)("div",{className:"mb-8 flex justify-center",children:(0,t.jsx)("img",{src:"/pcmaker.png",alt:"Logo",className:"h-20 w-20 rounded-full shadow"})}),(0,t.jsx)("nav",{className:"flex-1 flex flex-col space-y-1 items-center",children:o.map(e=>(0,t.jsxs)(i.motion.button,{onClick:()=>p(e.path),whileHover:{scale:1.08},className:"flex flex-col items-center w-full py-3 rounded-xl text-xl px-2 transition-colors ".concat(n===e.path?"bg-indigo-50 text-indigo-600":"text-gray-400 hover:bg-gray-100 hover:text-indigo-600"),title:e.label,children:[(0,t.jsx)("div",{children:e.icon}),(0,t.jsx)("span",{className:"text-[11px] mt-1 font-medium",children:e.label})]},e.label))}),(0,t.jsx)("button",{className:"lg:hidden mt-8 bg-gray-200 text-gray-600 px-4 py-2 rounded",onClick:()=>d(!1),children:"Cerrar"})]}),c&&!u&&(0,t.jsx)("div",{className:"fixed inset-0 bg-white bg-opacity-40 z-20 lg:hidden",onClick:()=>d(!1)})]})}var l=e.i(38325);let c="https://erp.pcmaker.mx";function d(){var e,r;let[s,o]=(0,a.useState)([]),[n,d]=(0,a.useState)([]),[u,m]=(0,a.useState)({nombre:"",email:"",password:"",rol_id:2,activo:!0,sucursal_id:void 0}),[x,p]=(0,a.useState)(null);(0,a.useEffect)(()=>{fetch("".concat(c,"/api/usuarios/"),{credentials:"include"}).then(e=>e.ok?e.json():Promise.reject()).then(e=>o(e)).catch(()=>{o([]),l.default.fire({icon:"error",title:"Error",text:"No se pudieron cargar los usuarios"})})},[]),(0,a.useEffect)(()=>{fetch("".concat(c,"/api/sucursales"),{credentials:"include"}).then(e=>e.ok?e.json():Promise.reject()).then(e=>d(e)).catch(()=>{d([]),l.default.fire({icon:"error",title:"Error",text:"No se pudieron cargar las sucursales"})})},[]);let f=async e=>{e.preventDefault();let t=x?"".concat(c,"/api/usuarios/").concat(x):"".concat(c,"/api/usuarios/"),a=x?"PUT":"POST",r={...u};"PUT"!==a||r.password||delete r.password;try{let e=await fetch(t,{method:a,headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r)}),i=await e.json();e.ok?(x?(o(s.map(e=>e.id===x?i:e)),l.default.fire({icon:"success",title:"Usuario actualizado",timer:1200,showConfirmButton:!1})):(o([...s,i]),l.default.fire({icon:"success",title:"Usuario creado",timer:1200,showConfirmButton:!1})),m({nombre:"",email:"",password:"",rol_id:2,activo:!0}),p(null)):l.default.fire({icon:"error",title:"Error",text:i.message||"No se pudo guardar el usuario"})}catch(e){l.default.fire({icon:"error",title:"Error",text:"Error de conexión al servidor"})}},h=async e=>{(await l.default.fire({icon:"warning",title:"¿Eliminar usuario?",text:"Esta acción no se puede deshacer",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"})).isConfirmed&&((await fetch("".concat(c,"/api/usuarios/").concat(e),{method:"DELETE",credentials:"include"})).ok?(o(s.filter(t=>t.id!==e)),l.default.fire({icon:"success",title:"Usuario eliminado",timer:1200,showConfirmButton:!1})):l.default.fire({icon:"error",title:"Error",text:"No se pudo eliminar el usuario"}))},g=async(e,t)=>{let a=s.find(t=>t.id===e);a&&((await fetch("".concat(c,"/api/usuarios/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...a,activo:!t})})).ok?(o(s.map(a=>a.id===e?{...a,activo:!t}:a)),l.default.fire({icon:"success",title:"Usuario ".concat(t?"desactivado":"activado"),timer:1e3,showConfirmButton:!1})):l.default.fire({icon:"error",title:"Error",text:"No se pudo cambiar el estado"}))};return(0,t.jsxs)(i.motion.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:70},className:"bg-white rounded-xl shadow p-4 sm:p-6 max-w-full sm:max-w-6xl w-full",children:[(0,t.jsx)("h2",{className:"text-lg sm:text-xl font-semibold mb-4 sm:mb-6 text-gray-700 text-center sm:text-left",children:"Gestión de Usuarios y Roles"}),(0,t.jsxs)("form",{className:"mb-6 flex flex-col sm:flex-row flex-wrap gap-2 items-stretch sm:items-end",onSubmit:f,children:[(0,t.jsx)("input",{type:"text",required:!0,placeholder:"Nombre",className:"border px-3 py-2 rounded w-full sm:w-36 text-sm",value:u.nombre,onChange:e=>m(t=>({...t,nombre:e.target.value}))}),(0,t.jsx)("input",{type:"email",required:!0,placeholder:"Email",className:"border px-3 py-2 rounded w-full sm:w-44 text-sm",value:u.email,onChange:e=>m(t=>({...t,email:e.target.value}))}),(0,t.jsxs)("select",{required:!0,className:"border px-3 py-2 rounded w-full sm:w-auto text-sm",value:u.rol_id,onChange:e=>m(t=>({...t,rol_id:Number(e.target.value)})),children:[(0,t.jsx)("option",{value:1,children:"Administrador"}),(0,t.jsx)("option",{value:2,children:"Técnico"}),(0,t.jsx)("option",{value:3,children:"Ventas"})]}),(0,t.jsxs)("select",{required:!0,className:"border px-3 py-2 rounded w-full sm:w-auto text-sm",value:null!=(e=u.sucursal_id)?e:"",onChange:e=>m(t=>({...t,sucursal_id:Number(e.target.value)})),children:[(0,t.jsx)("option",{value:"",children:"Seleccionar sucursal"}),n.map(e=>(0,t.jsx)("option",{value:e.id,children:e.nombre},e.id))]}),(0,t.jsx)("input",{type:"password",placeholder:"Contraseña",className:"border px-3 py-2 rounded w-full sm:w-36 text-sm",value:null!=(r=u.password)?r:"",onChange:e=>m(t=>({...t,password:e.target.value}))}),(0,t.jsx)("button",{className:"bg-indigo-600 text-white rounded px-4 py-2 text-sm hover:bg-indigo-500 w-full sm:w-auto",children:x?"Actualizar":"Crear"}),x&&(0,t.jsx)("button",{type:"button",onClick:()=>{m({nombre:"",email:"",password:"",rol_id:2,activo:!0}),p(null)},className:"rounded px-3 py-2 ml-0 sm:ml-2 text-xs bg-gray-300 text-gray-800 w-full sm:w-auto",children:"Cancelar"})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full table-auto text-xs sm:text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-2 sm:p-3 border-b text-left font-medium text-gray-600",children:"Nombre"}),(0,t.jsx)("th",{className:"p-2 sm:p-3 border-b text-left font-medium text-gray-600 w-[45%]",children:"Email"}),(0,t.jsx)("th",{className:"p-2 sm:p-3 border-b text-left font-medium text-gray-600",children:"Rol"}),(0,t.jsx)("th",{className:"p-2 sm:p-3 border-b text-left font-medium text-gray-600",children:"Sucursal"}),(0,t.jsx)("th",{className:"p-2 sm:p-3 border-b text-center font-medium text-gray-600",children:"Activo"}),(0,t.jsx)("th",{className:"p-2 sm:p-3 border-b"}),(0,t.jsx)("th",{className:"p-2 sm:p-3 border-b"})]})}),(0,t.jsx)("tbody",{children:s.map(e=>{var a;let r;return(0,t.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,t.jsx)("td",{className:"p-2 sm:p-3",children:e.nombre}),(0,t.jsx)("td",{className:"p-2 sm:p-3 w-[45%] break-words",children:e.email}),(0,t.jsx)("td",{className:"p-2 sm:p-3",children:1===(r=e.rol_id)?"Administrador":2===r?"Técnico":"Ventas"}),(0,t.jsx)("td",{className:"p-2 sm:p-3",children:(null==(a=n.find(t=>t.id===e.sucursal_id))?void 0:a.nombre)||"—"}),(0,t.jsx)("td",{className:"p-2 sm:p-3 text-center",children:(0,t.jsx)("button",{onClick:()=>g(e.id,e.activo),className:"rounded px-3 py-1 text-xs font-semibold ".concat(e.activo?"bg-green-200 text-green-800":"bg-red-200 text-red-800"),children:e.activo?"Sí":"No"})}),(0,t.jsx)("td",{className:"p-2 sm:p-3 text-center",children:(0,t.jsx)("button",{className:"text-indigo-600 hover:underline text-xs sm:text-sm",onClick:()=>{m({...e,password:""}),p(e.id),l.default.fire({icon:"info",title:"Modo edición",text:"Editando a ".concat(e.nombre),timer:1100,showConfirmButton:!1})},children:"Editar"})}),(0,t.jsx)("td",{className:"p-2 sm:p-3 text-center",children:(0,t.jsx)("button",{className:"text-red-600 ml-0 sm:ml-2 hover:underline text-xs sm:text-sm",onClick:()=>h(e.id),children:"Eliminar"})})]},e.id)})})]})})]})}var u=e.i(32508);let m=[{id:1,title:"Reporte Ventas Septiembre",date:"2025-09-15"},{id:2,title:"Reporte Mantenimientos Septiembre",date:"2025-09-15"},{id:3,title:"Comisiones Q3 2025",date:"2025-09-15"}];function x(){return(0,t.jsxs)(i.motion.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:70},className:"bg-white rounded-xl shadow p-6 max-w-5xl",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-6 text-gray-700",children:"Reportes del sistema"}),(0,t.jsx)("ul",{children:m.map(e=>(0,t.jsx)("li",{className:"mb-3",children:(0,t.jsxs)("a",{href:"#",className:"text-indigo-600 hover:underline text-sm font-medium",onClick:t=>{t.preventDefault(),alert("Descargando ".concat(e.title))},children:[e.title," - ",e.date]})},e.id))})]})}function p(){let[e,r]=(0,a.useState)([]),[o,n]=(0,a.useState)(!0),c="https://erp.pcmaker.mx",d=async()=>{try{n(!0);let e=await fetch("".concat(c,"/api/configuraciones"),{credentials:"include"});if(!e.ok)throw Error("Error al obtener configuraciones");let t=await e.json();r(t)}catch(e){console.error("Error cargando configuraciones:",e),l.default.fire("Error","No se pudieron cargar las configuraciones","error")}finally{n(!1)}};(0,a.useEffect)(()=>{d()},[]);let u=async e=>{try{let t=await fetch("".concat(c,"/api/configuraciones/").concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({nombre:e.nombre,valor:e.valor,descripcion:e.descripcion})});if(!t.ok)throw Error("Error al actualizar");let a=await t.json();r(e=>e.map(e=>e.id===a.id?a:e)),l.default.fire("Guardado","Configuración actualizada correctamente","success")}catch(e){console.error(e),l.default.fire("Error","No se pudo actualizar la configuración","error")}},m=async()=>{let{value:e}=await l.default.fire({title:"Nueva configuración",html:'\n        <input id="nombre" class="swal2-input" placeholder="Nombre (ej. comision_armado)">\n        <input id="valor" class="swal2-input" placeholder="Valor (ej. 3 o 20)">\n        <input id="descripcion" class="swal2-input" placeholder="Descripción (opcional)">\n      ',focusConfirm:!1,showCancelButton:!0,confirmButtonText:"Guardar",preConfirm:()=>{let e=document.getElementById("nombre").value,t=document.getElementById("valor").value,a=document.getElementById("descripcion").value;return e&&t?{nombre:e,valor:t,descripcion:a}:(l.default.showValidationMessage("Nombre y valor son requeridos"),null)}});if(e)try{let t=await fetch("".concat(c,"/api/configuraciones"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok)throw Error("Error al crear");let a=await t.json();r(e=>[...e,a]),l.default.fire("Agregado","Configuración creada correctamente","success")}catch(e){console.error(e),l.default.fire("Error","No se pudo crear la configuración","error")}},x=async e=>{if((await l.default.fire({title:"¿Eliminar configuración?",text:"Esta acción no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{if(!(await fetch("".concat(c,"/api/configuraciones/").concat(e),{method:"DELETE",credentials:"include"})).ok)throw Error("Error al eliminar");r(t=>t.filter(t=>t.id!==e)),l.default.fire("Eliminado","Configuración eliminada correctamente","success")}catch(e){console.error(e),l.default.fire("Error","No se pudo eliminar la configuración","error")}};return o?(0,t.jsx)("div",{className:"text-center text-gray-500 py-6",children:"Cargando configuraciones..."}):(0,t.jsxs)(i.motion.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:70},className:"bg-white rounded-xl shadow p-6 max-w-4xl",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-700",children:"Configuración del sistema"}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)("button",{onClick:m,className:"flex items-center gap-2 bg-indigo-600 text-white px-3 py-2 rounded-lg shadow hover:bg-indigo-700",children:[(0,t.jsx)(s.FaPlus,{})," Agregar"]}),(0,t.jsxs)("button",{onClick:d,className:"flex items-center gap-2 bg-gray-200 text-gray-700 px-3 py-2 rounded-lg shadow hover:bg-gray-300",children:[(0,t.jsx)(s.FaSync,{})," Recargar"]})]})]}),(0,t.jsx)("ul",{className:"space-y-4",children:e.map(e=>(0,t.jsxs)("li",{className:"flex flex-col sm:flex-row sm:items-center gap-3 border-b border-gray-100 pb-3",children:[(0,t.jsx)("label",{className:"sm:w-64 font-medium text-gray-700",children:e.nombre}),(0,t.jsx)("input",{type:"text",value:e.valor,onChange:t=>r(a=>a.map(a=>a.id===e.id?{...a,valor:t.target.value}:a)),className:"border rounded-md p-2 flex-1 text-gray-600"}),(0,t.jsxs)("div",{className:"flex gap-3 justify-end sm:justify-normal",children:[(0,t.jsx)("button",{onClick:()=>u(e),className:"text-green-600 hover:text-green-800",children:(0,t.jsx)(s.FaSave,{})}),(0,t.jsx)("button",{onClick:()=>x(e.id),className:"text-red-500 hover:text-red-700",children:(0,t.jsx)(s.FaTrash,{})})]})]},e.id))})]})}var f=e.i(37348);function h(){let[e,i]=(0,a.useState)("usuarios"),s=(0,r.useRouter)();return(0,a.useEffect)(()=>{fetch("".concat("https://erp.pcmaker.mx","/api/usuarios/me"),{credentials:"include"}).then(e=>{if(!e.ok)throw Error("No autenticado");return e.json()}).then(e=>{var t;(null==(t=e.user)?void 0:t.rol_id)!==1&&s.push("/login")}).catch(()=>{s.push("/login")})},[s]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n,{active:e,setActive:i}),(0,t.jsxs)("main",{className:"flex-1 p-8 overflow-auto lg:ml-24",children:["usuarios"===e&&(0,t.jsx)(d,{}),"inventario"===e&&(0,t.jsx)(u.default,{}),"reportes"===e&&(0,t.jsx)(x,{}),"configuracion"===e&&(0,t.jsx)(p,{}),"lote"===e&&(0,t.jsx)(f.default,{})]})]})}},87083,e=>{e.v(t=>Promise.all(["static/chunks/cdb9f38e8c15eeaa.js"].map(t=>e.l(t))).then(()=>t(27169)))},97650,e=>{e.v(t=>Promise.all(["static/chunks/73b624621f3decf5.js"].map(t=>e.l(t))).then(()=>t(90557)))}]);