(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,a)=>{t.exports=e.r(76562)},90908,e=>{"use strict";e.s(["default",()=>b],90908),e.i(47167);var t=e.i(43476),a=e.i(71645),i=e.i(18566),o=e.i(46932),n=e.i(11152);let r=[{label:"Inventario",icon:(0,t.jsx)(n.FaBoxOpen,{}),path:"inventario"},{label:"Mantenimientos",icon:(0,t.jsx)(n.FaTools,{}),path:"mantenimientos"},{label:"Historial",icon:(0,t.jsx)(n.FaHistory,{}),path:"historial"},{label:"Revisar Equipos",icon:(0,t.jsx)(n.FaFileAlt,{}),path:"especificaciones"},{label:"Comisiones",icon:(0,t.jsx)(n.FaDollarSign,{}),path:"comisiones"},{label:"Recibir lote",icon:(0,t.jsx)(n.FaTruck,{}),path:"lote"},{label:"Cerrar sesiÃ³n",icon:(0,t.jsx)(n.FaSignOutAlt,{}),path:"logout"}];function s(e){let{active:s,setActive:l}=e,[c,d]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1),p=(0,i.useRouter)();(0,a.useEffect)(()=>{let e=()=>m(window.innerWidth>=1024);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let h=async e=>{if("logout"===e){await fetch("".concat("https://erp.pcmaker.mx","/api/usuarios/logout"),{method:"POST",credentials:"include"}),localStorage.removeItem("email"),p.push("/login");return}l(e),d(!1)};return(0,t.jsxs)(t.Fragment,{children:[!u&&(0,t.jsx)("button",{className:"fixed top-5 left-5 z-40 bg-indigo-600 text-white p-2 rounded-full shadow lg:hidden",onClick:()=>d(!0),children:(0,t.jsx)(n.FaBars,{size:20})}),(0,t.jsxs)(o.motion.aside,{initial:!1,animate:{x:u||c?0:-140},transition:{type:"spring",stiffness:80,delay:.15},className:"\n          fixed top-0 left-0 z-30 h-full bg-white\n          border-r border-gray-200 shadow-sm py-4 px-4\n          flex flex-col\n          overflow-y-hidden\n          overflow-x-hidden\n          w-25\n          ".concat(c?"block":"hidden"," lg:flex\n        "),style:c&&!u?{boxShadow:"0 0 0 100vmax rgba(0,0,0,0.4)"}:{},children:[(0,t.jsx)("div",{className:"mb-8 flex justify-center",children:(0,t.jsx)("img",{src:"/pcmaker.png",alt:"Logo",className:"h-20 w-20 rounded-full shadow"})}),(0,t.jsx)("nav",{className:"flex-1 flex flex-col space-y-1 items-center",children:r.map(e=>(0,t.jsxs)(o.motion.button,{onClick:()=>h(e.path),whileHover:{scale:1.08},className:"flex flex-col items-center w-full py-3 rounded-xl text-xl px-2 transition-colors ".concat(s===e.path?"bg-indigo-50 text-indigo-600":"text-gray-400 hover:bg-gray-100 hover:text-indigo-600"),title:e.label,children:[(0,t.jsx)("div",{children:e.icon}),(0,t.jsx)("span",{className:"text-[11px] mt-1 font-medium",children:e.label})]},e.label))}),!u&&(0,t.jsx)("button",{className:"mt-8 bg-gray-200 text-gray-600 px-4 py-2 rounded lg:hidden",onClick:()=>d(!1),children:"Cerrar"})]}),c&&!u&&(0,t.jsx)("div",{className:"fixed inset-0 bg-white bg-opacity-40 z-20 lg:hidden",onClick:()=>d(!1)})]})}var l=e.i(32508),c=e.i(38325);let d="https://erp.pcmaker.mx";function u(){let[e,i]=(0,a.useState)({equipo:"",detalle:"",fecha:"",tecnico:"",tipoMantenimiento:"",otroDescripcion:"",otroCosto:""}),[n,r]=(0,a.useState)(null),[s,l]=(0,a.useState)([]),[u,m]=(0,a.useState)(null),[p,h]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=new Date,t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0"),n="".concat(t,"-").concat(a,"-").concat(o);i(e=>({...e,fecha:n})),fetch("".concat(d,"/api/usuarios/me"),{credentials:"include"}).then(e=>{if(!e.ok)throw Error("No autenticado");return e.json()}).then(e=>{i(t=>({...t,tecnico:e.user.nombre})),r(e.user.id)}).catch(()=>{window.location.href="/login"})},[]),(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat(d,"/api/catalogoMantenimiento"),{credentials:"include"});if(e.ok){let t=[...await e.json(),{id:"otro",descripcion:"Otro",costo:0}];l(t)}}catch(e){console.error("Error cargando catÃ¡logo:",e)}finally{h(!1)}})()},[]);let f=async(e,t,a)=>{try{let i=await fetch("".concat(d,"/api/configuraciones/comision_mantenimiento"),{credentials:"include"}),o=.03;if(i.ok){let e=await i.json();if(null==e?void 0:e.valor){let t=parseFloat(e.valor);isNaN(t)||(o=t)}}else console.warn("âš ï¸ No se pudo obtener la configuraciÃ³n de comisiÃ³n, usando valor por defecto (3%)");let n=a*o;if((await fetch("".concat(d,"/api/comisiones"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({usuario_id:t,venta_id:null,mantenimiento_id:e.id,monto:n,fecha_creacion:new Date().toISOString(),equipo_id:e.equipo_id||null})})).ok)return!0;return console.error("âŒ Error al generar comisiÃ³n"),!1}catch(e){return console.error("Error generando comisiÃ³n:",e),!1}},x=async t=>{if(t.preventDefault(),!e.fecha||!e.detalle||!n||!e.tipoMantenimiento)return void c.default.fire({icon:"warning",title:"Campos incompletos",text:"Por favor completa todos los campos requeridos."});let a=e.tipoMantenimiento;try{if("otro"===a){if(!e.otroDescripcion||!e.otroCosto)return void c.default.fire({icon:"warning",title:"Datos faltantes",text:"Debes proporcionar la descripciÃ³n y el costo del nuevo mantenimiento."});let t=await fetch("".concat(d,"/api/catalogoMantenimiento"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({descripcion:e.otroDescripcion,costo:parseFloat(e.otroCosto)})});if(!t.ok)throw Error("Error al crear tipo de mantenimiento");a=(await t.json()).id}let t={fecha_mantenimiento:e.fecha,detalle:e.detalle,tecnico_id:n,catalogo_id:a},o=await fetch("".concat(d,"/api/mantenimientos"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(o.ok){let t=await o.json();await f(t,n,u||0),c.default.fire({icon:"success",title:"Mantenimiento guardado",text:"El mantenimiento ha sido registrado correctamente"}),i(t=>({...t,equipo:"",detalle:"",tipoMantenimiento:"",otroDescripcion:"",otroCosto:"",fecha:e.fecha,tecnico:e.tecnico})),m(null)}else c.default.fire({icon:"error",title:"Error",text:"No se pudo guardar el mantenimiento"})}catch(e){console.error(e),c.default.fire({icon:"error",title:"Error de conexiÃ³n",text:"Hubo un problema con la solicitud al servidor"})}};return p?(0,t.jsx)("p",{children:"Cargando catÃ¡logo..."}):(0,t.jsxs)(o.motion.div,{initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{type:"spring",stiffness:70,delay:.1},className:"bg-white rounded-xl shadow p-6 max-w-xl",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Registrar mantenimiento"}),(0,t.jsxs)("form",{className:"flex flex-col gap-3",onSubmit:x,children:[(0,t.jsx)("input",{required:!0,type:"date",className:"border rounded-md p-2 text-gray-600",value:e.fecha,onChange:t=>i({...e,fecha:t.target.value})}),(0,t.jsxs)("select",{required:!0,className:"border rounded-md p-2 text-gray-600",value:e.tipoMantenimiento,onChange:t=>(t=>{if(i({...e,tipoMantenimiento:t}),"otro"===t)m(null);else{let e=s.find(e=>e.id===parseInt(t));m(e?e.costo:null)}})(t.target.value),children:[(0,t.jsx)("option",{value:"",children:"Seleccionar tipo de mantenimiento"}),s.map(e=>(0,t.jsx)("option",{value:e.id,children:e.descripcion},e.id))]}),e.tipoMantenimiento&&"otro"!==e.tipoMantenimiento&&(0,t.jsx)("input",{type:"text",readOnly:!0,className:"border rounded-md p-2 text-gray-600 bg-gray-100",value:null===u||isNaN(Number(u))?"Sin costo definido":"$".concat(Number(u).toFixed(2))}),"otro"===e.tipoMantenimiento&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"text",placeholder:"DescripciÃ³n del nuevo mantenimiento",className:"border rounded-md p-2 text-gray-600",value:e.otroDescripcion,onChange:t=>i({...e,otroDescripcion:t.target.value})}),(0,t.jsx)("input",{type:"number",placeholder:"Costo del nuevo mantenimiento",className:"border rounded-md p-2 text-gray-600",value:e.otroCosto,onChange:t=>i({...e,otroCosto:t.target.value})})]}),(0,t.jsx)("textarea",{required:!0,placeholder:"Detalle tÃ©cnico",className:"border rounded-md p-2 text-gray-600 resize-none",rows:3,value:e.detalle,onChange:t=>i({...e,detalle:t.target.value})}),(0,t.jsx)("input",{type:"text",placeholder:"TÃ©cnico responsable",className:"border rounded-md p-2 text-gray-600",value:e.tecnico,readOnly:!0}),(0,t.jsx)(o.motion.button,{whileTap:{scale:.97},className:"mt-2 bg-indigo-600 text-white rounded-md py-2 font-medium transition-colors hover:bg-indigo-700",type:"submit",children:"Guardar mantenimiento"})]})]})}function m(){let[e,i]=(0,a.useState)([]),[n,r]=(0,a.useState)(!0),[s,l]=(0,a.useState)(1),[c,d]=(0,a.useState)(1);(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat("https://erp.pcmaker.mx","/api/historial-tecnico?page=").concat(s,"&limit=5"),{credentials:"include"});if(!e.ok)throw Error("Error obteniendo historial");let t=await e.json(),a=t.data.map(e=>({equipo:e.equipo,estado:"Equipo"===e.tipo?u(e.estado_id):"Mantenimiento realizado",fecha:new Date(e.fecha).toISOString().split("T")[0],tipo:e.tipo}));i(a),d(t.totalPages)}catch(e){console.error("Error cargando historial:",e)}finally{r(!1)}})()},[s]);let u=e=>{switch(e){case 1:return"En espera";case 2:return"En revisiÃ³n";case 3:return"No Funciona";case 4:return"Ensamblado";case 5:return"Listo para venta";default:return"Desconocido"}};return n?(0,t.jsx)("div",{className:"bg-white rounded-xl shadow p-6 max-w-2xl text-center text-gray-500",children:"Cargando historial..."}):(0,t.jsxs)(o.motion.div,{initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{type:"spring",stiffness:70,delay:.2},className:"bg-white rounded-xl shadow p-6 max-w-2xl",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Historial de equipos"}),(0,t.jsx)("ol",{className:"relative border-l-2 border-indigo-200 pl-6",children:0===e.length?(0,t.jsx)("p",{className:"text-gray-400 text-sm",children:"No hay registros disponibles"}):e.map((e,a)=>(0,t.jsxs)(o.motion.li,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2+.07*a},className:"mb-8",children:[(0,t.jsx)("div",{className:"absolute -left-4 w-3 h-3 bg-indigo-500 rounded-full border-2 border-white"}),(0,t.jsx)("div",{className:"text-md font-semibold text-gray-800",children:e.equipo}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:e.estado}),(0,t.jsx)("div",{className:"text-xs text-gray-400",children:e.fecha})]},a))}),(0,t.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,t.jsx)("button",{disabled:s<=1,onClick:()=>l(e=>e-1),className:"text-sm font-medium ".concat(s<=1?"text-gray-300 cursor-not-allowed":"text-indigo-600 hover:text-indigo-800"),children:"â† Anterior"}),(0,t.jsxs)("span",{className:"text-gray-500 text-sm",children:["PÃ¡gina ",s," de ",c]}),(0,t.jsx)("button",{disabled:s>=c,onClick:()=>l(e=>e+1),className:"text-sm font-medium ".concat(s>=c?"text-gray-300 cursor-not-allowed":"text-indigo-600 hover:text-indigo-800"),children:"Siguiente â†’"})]})]})}let p="https://erp.pcmaker.mx";function h(){let[e,n]=(0,a.useState)({modelo:"",procesador:"",observaciones:"",detalles:""}),[r,s]=(0,a.useState)([]),[l,d]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),[h,f]=(0,a.useState)([]),[x,g]=(0,a.useState)(""),[b,y]=(0,a.useState)([]),[j,v]=(0,a.useState)(""),[w,_]=(0,a.useState)(!1),[N,S]=(0,a.useState)(null),[E,q]=(0,a.useState)(null),[C,k]=(0,a.useState)(null),O=(0,i.useRouter)(),[T,M]=(0,a.useState)([]),[D,F]=(0,a.useState)([]),[P,A]=(0,a.useState)([{memoria_ram_id:""}]),[R,I]=(0,a.useState)([{almacenamiento_id:""}]);function J(e,t){let a={};return e.forEach(e=>{let i=e[t];"number"==typeof i&&(a[i]=(a[i]||0)+1)}),a}(0,a.useEffect)(()=>{fetch("".concat(p,"/api/catalogoEstados"),{credentials:"include"}).then(e=>e.json()).then(e=>f(e)).catch(()=>{f([]),c.default.fire({icon:"error",title:"Error",text:"No se pudieron cargar los estados."})})},[]),(0,a.useEffect)(()=>{fetch("".concat(p,"/api/usuarios/me"),{credentials:"include"}).then(e=>{if(!e.ok)throw Error("No autenticado");return e.json()}).then(e=>{q(e.user.id),k(e.user.sucursal_id)}).catch(()=>O.push("/login"))},[O]),(0,a.useEffect)(()=>{fetch("".concat(p,"/api/catalogoMemoriaRam"),{credentials:"include"}).then(e=>e.json()).then(e=>M(e)).catch(()=>M([])),fetch("".concat(p,"/api/catalogoAlmacenamiento"),{credentials:"include"}).then(e=>e.json()).then(e=>F(e)).catch(()=>F([]))},[]),(0,a.useEffect)(()=>{if(u){var e;let t=(null==(e=b.find(e=>e.lote_etiqueta_id===u))?void 0:e.etiqueta)||"";t&&fetch("".concat(p,"/api/equipos/buscar?texto=").concat(encodeURIComponent(t)),{credentials:"include"}).then(e=>e.ok?e.json():null).then(e=>{e?(n({modelo:e.nombre,procesador:e.procesador,observaciones:"",detalles:""}),g(e.estado_id),_(4===e.estado_id),S(e)):(n({modelo:"",procesador:"",observaciones:"",detalles:""}),g(""),_(!1),S(null))})}else n({modelo:"",procesador:"",observaciones:"",detalles:""}),g(""),_(!1),S(null)},[u,b]),(0,a.useEffect)(()=>{fetch("".concat(p,"/api/lotes"),{method:"GET",credentials:"include"}).then(e=>e.json()).then(e=>s(e)).catch(()=>{s([]),c.default.fire({icon:"error",title:"Error",text:"No se pudieron cargar los lotes."})})},[]),(0,a.useEffect)(()=>{if(l){let e=r.find(e=>e.etiqueta===l);e?fetch("".concat(p,"/api/lotes/").concat(e.id,"/etiquetas"),{credentials:"include"}).then(e=>e.json()).then(e=>y(e)).catch(()=>{y([]),c.default.fire({icon:"error",title:"Error",text:"No se pudo obtener las series del lote seleccionado."})}):y([])}else y([]);m("")},[l,r]);let z=async(e,t)=>{let a=J(e,"memoria_ram_id"),i=J(t,"almacenamiento_id");for(let[e,t]of Object.entries(a)){let a=await fetch("".concat(p,"/api/inventario/validar-stock?memoria_ram_id=").concat(e,"&cantidad=").concat(t,"&sucursal_id=").concat(C),{credentials:"include"}),i=await a.json();if(!i||!i.tieneStock)return await c.default.fire({icon:"warning",title:"Stock insuficiente",text:"No hay suficiente stock para el mÃ³dulo RAM seleccionado (".concat(t," requerido).")}),!1}for(let[e,t]of Object.entries(i)){let a=await fetch("".concat(p,"/api/inventario/validar-stock?almacenamiento_id=").concat(e,"&cantidad=").concat(t,"&sucursal_id=").concat(C),{credentials:"include"}),i=await a.json();if(!i||!i.tieneStock)return await c.default.fire({icon:"warning",title:"Stock insuficiente",text:"No hay suficiente stock para el almacenamiento seleccionado (".concat(t," requerido).")}),!1}return!0},L=async()=>{if(j.trim())try{let e=await fetch("".concat(p,"/api/equipos/buscar?texto=").concat(encodeURIComponent(j)),{credentials:"include"});if(!e.ok)throw Error("Equipo no encontrado");let t=await e.json(),a=b.find(e=>e.lote_etiqueta_id===t.lote_etiqueta_id),i=r.find(e=>e.id===((null==a?void 0:a.lote_id)||t.lote_id));i?(d(i.etiqueta),fetch("".concat(p,"/api/lotes/").concat(i.id,"/etiquetas"),{credentials:"include"}).then(e=>e.json()).then(e=>{y(e),m(t.lote_etiqueta_id)})):(d(""),y([]),m("")),n({modelo:t.nombre,procesador:t.procesador,observaciones:"",detalles:""}),g(t.estado_id),_(4===t.estado_id)}catch(e){c.default.fire({icon:"error",title:"Error",text:e.message||"No se encontrÃ³ el equipo"}),_(!1)}},B=async(e,t)=>{try{let a=await fetch("".concat(p,"/api/comisiones/equipo/").concat(e.id),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}),i=await a.json();if(i&&i.id)return!0;let o=20;try{let e=await fetch("".concat(p,"/api/configuraciones/comision_armado"),{credentials:"include"});if(e.ok){let t=await e.json(),a=parseFloat(null==t?void 0:t.valor);isNaN(a)||(o=a)}else console.warn("âš ï¸ No se pudo obtener comision_armado, usando valor por defecto (20)")}catch(e){console.error("Error al obtener configuraciÃ³n de comisiÃ³n:",e)}if((await fetch("".concat(p,"/api/comisiones"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({usuario_id:t,venta_id:null,mantenimiento_id:null,monto:o,fecha_creacion:new Date().toISOString(),equipo_id:e.id})})).ok)return!0;return console.error("âŒ Error al generar comisiÃ³n por armado"),!1}catch(e){return console.error("Error generando comisiÃ³n:",e),!1}},G=async e=>{try{let t,a;if(!r.find(t=>t.etiqueta===e.lote))throw Error("Lote no vÃ¡lido");let i={nombre:e.specs.modelo,descripcion:"Procesador: ".concat(e.specs.procesador,". Observaciones: ").concat(e.specs.observaciones),procesador:e.specs.procesador,tipo:"equipo",lote_etiqueta_id:e.lote_etiqueta_id,estado_id:e.estado_id,cantidad:1,sucursal_id:C,tecnico_id:E,ramModules:e.ramModules.filter(e=>e.memoria_ram_id),storages:e.storages.filter(e=>e.almacenamiento_id)};if(!(t=N?await fetch("".concat(p,"/api/equipos/").concat(N.id),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(i)}):await fetch("".concat(p,"/api/equipos"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...i,fecha_creacion:new Date().toISOString()})})).ok)throw Error("Error guardando equipo");if(a=await t.json(),4===e.estado_id){for(let t of e.ramModules.filter(e=>e.memoria_ram_id))await fetch("".concat(p,"/api/inventario/descontar"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({memoria_ram_id:t.memoria_ram_id,cantidad:t.cantidad||1,sucursal_id:C})});for(let t of e.storages.filter(e=>e.almacenamiento_id))await fetch("".concat(p,"/api/inventario/descontar"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({almacenamiento_id:t.almacenamiento_id,cantidad:t.cantidad||1,sucursal_id:C})});try{let e=await fetch("".concat(p,"/api/inventario/registrar-equipo"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({equipo_id:a.id,sucursal_id:C,precio:0})});if(e.ok)console.log("âœ… Equipo registrado en inventario correctamente.");else{let t=await e.json();console.error("âŒ Error registrando equipo en inventario:",t)}}catch(e){console.error("âš ï¸ Error en la peticiÃ³n de registro de inventario:",e)}}else{for(let t of e.ramModules.filter(e=>e.memoria_ram_id)){let e={tipo:"RAM",especificacion:"",cantidad:t.cantidad||1,estado:"usado",fecha_creacion:new Date().toISOString(),memoria_ram_id:t.memoria_ram_id,almacenamiento_id:null,sucursal_id:C};await fetch("".concat(p,"/api/inventario"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)})}for(let t of e.storages.filter(e=>e.almacenamiento_id)){let e={tipo:"Almacenamiento",especificacion:"",cantidad:t.cantidad||1,estado:"usado",fecha_creacion:new Date().toISOString(),memoria_ram_id:null,almacenamiento_id:t.almacenamiento_id,sucursal_id:C};await fetch("".concat(p,"/api/inventario"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)})}}return{success:!0,equipo:a}}catch(e){return console.error("Error guardando revisiÃ³n:",e),{success:!1,error:e}}},H=async t=>{if(t.preventDefault(),!l||!u||!e.modelo||!e.procesador||!x)return c.default.fire({icon:"warning",title:"Campos requeridos",text:"Completa todos los campos obligatorios."});let a={lote:l,lote_etiqueta_id:u,specs:e,estado_id:x,tecnico_id:E,ramModules:P.filter(e=>e.memoria_ram_id).map(e=>({memoria_ram_id:e.memoria_ram_id,cantidad:e.cantidad||1,slot:e.slot||null})),storages:R.filter(e=>e.almacenamiento_id).map(e=>({almacenamiento_id:e.almacenamiento_id,rol:e.rol||null,capacidad_override:e.capacidad_override||null,orden:e.orden||null}))};if(4===x){let e=P.some(e=>e.memoria_ram_id),t=R.some(e=>e.almacenamiento_id);if(!e||!t)return void await c.default.fire({icon:"warning",title:"Componentes faltantes",text:"Debes seleccionar al menos un mÃ³dulo de RAM y un tipo de almacenamiento antes de guardar."});if(!await z(P,R))return}let i=await G(a);if(i.success){if(4===x)if("number"!=typeof E)return void c.default.fire({icon:"error",title:"Usuario invÃ¡lido",text:"No se puede obtener el identificador del tÃ©cnico."});else await B(i.equipo,E);c.default.fire({icon:"success",title:"Guardado",text:"La especificaciÃ³n ha sido guardada correctamente."}),n({modelo:"",procesador:"",observaciones:"",detalles:""}),d(""),g(""),A([{memoria_ram_id:""}]),I([{almacenamiento_id:""}])}else c.default.fire({icon:"error",title:"Error",text:"OcurriÃ³ un error guardando la especificaciÃ³n."})};return(0,t.jsxs)(o.motion.div,{initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{type:"spring",stiffness:70,delay:.15},className:"bg-white rounded-xl shadow p-6 max-w-xl",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4 w-full max-w-md",children:[(0,t.jsx)("input",{type:"text",placeholder:"Buscar por etiqueta o nÃºmero de serie",value:j,onChange:e=>v(e.target.value),className:"border rounded-md p-2 flex-grow",disabled:w}),(0,t.jsx)("button",{type:"button",className:"bg-indigo-600 text-white px-4 py-2 rounded-md",onClick:L,disabled:w,"aria-label":"Buscar equipo",children:"ðŸ”"})]}),(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Revisar Equipos"}),(0,t.jsxs)("form",{className:"flex flex-col gap-3",onSubmit:H,children:[(0,t.jsxs)("select",{value:l,onChange:e=>d(e.target.value),className:"border rounded-md p-2 text-gray-600",children:[(0,t.jsx)("option",{value:"",children:"Selecciona un lote"}),r.map(e=>(0,t.jsx)("option",{value:e.etiqueta,children:e.etiqueta},e.etiqueta))]}),(0,t.jsxs)("select",{value:u,onChange:e=>m(Number(e.target.value)),className:"border rounded-md p-2 text-gray-600",disabled:!b.length,children:[(0,t.jsx)("option",{value:"",children:b.length?"Selecciona un nÃºmero de serie":"Selecciona primero un lote"}),b.map(e=>(0,t.jsx)("option",{value:e.lote_etiqueta_id,children:e.etiqueta},e.lote_etiqueta_id))]}),(0,t.jsx)("input",{type:"text",placeholder:"Modelo (Ej: HP 290 G4)",className:"border rounded-md p-2 text-gray-600",value:e.modelo,onChange:t=>n({...e,modelo:t.target.value}),required:!0,disabled:w}),(0,t.jsx)("input",{type:"text",placeholder:"Procesador (Ej: Intel i5-8400)",className:"border rounded-md p-2 text-gray-600",value:e.procesador,onChange:t=>n({...e,procesador:t.target.value}),required:!0,disabled:w}),(0,t.jsx)("textarea",{placeholder:"Observaciones",className:"border rounded-md p-2 text-gray-600 resize-none",rows:2,value:e.observaciones,onChange:t=>n({...e,observaciones:t.target.value}),disabled:w}),(0,t.jsx)("textarea",{placeholder:"Detalles tÃ©cnicos",className:"border rounded-md p-2 text-gray-600 resize-none",rows:3,value:e.detalles,onChange:t=>n({...e,detalles:t.target.value}),disabled:w}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("label",{htmlFor:"estado",className:"font-semibold mb-1 block",children:"Estado"}),(0,t.jsxs)("select",{id:"estado",value:x,onChange:e=>g(Number(e.target.value)),className:"border rounded-md p-2 text-gray-600 w-full",required:!0,disabled:w,children:[(0,t.jsx)("option",{value:"",children:"Selecciona un estado"}),h.map(e=>(0,t.jsx)("option",{value:e.id,children:e.nombre},e.id))]})]}),(0,t.jsxs)("div",{className:"mt-4 border-t pt-4",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"font-semibold",children:4===x?"MÃ³dulos RAM incorporado":"MÃ³dulos RAM retirados"}),(0,t.jsx)("button",{type:"button",className:"text-indigo-600",onClick:()=>A([...P,{memoria_ram_id:""}]),children:"+ AÃ±adir mÃ³dulo"})]}),P.map((e,a)=>(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 mt-2 items-stretch",children:[(0,t.jsxs)("select",{className:"border rounded-md p-2 w-full",value:e.memoria_ram_id,onChange:e=>{let t;return t=Number(e.target.value),A(P.map((e,i)=>i===a?{...e,memoria_ram_id:t}:e))},disabled:w,children:[(0,t.jsx)("option",{value:"",children:"Selecciona tipo RAM"}),T.map(e=>(0,t.jsx)("option",{value:e.id,children:e.descripcion},e.id))]}),P.length>1&&(0,t.jsx)("button",{type:"button",onClick:()=>A(P.filter((e,t)=>t!==a)),className:"text-red-500 hover:underline",children:"Eliminar"})]},a))]}),(0,t.jsxs)("div",{className:"mt-4 border-t pt-4",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"font-semibold",children:4===x?"Almacenamiento incorporado":"Almacenamiento retirado"}),(0,t.jsx)("button",{type:"button",className:"text-indigo-600",onClick:()=>I([...R,{almacenamiento_id:""}]),children:"+ AÃ±adir Almacenamiento"})]}),R.map((e,a)=>(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 mt-2 items-stretch",children:[(0,t.jsxs)("select",{className:"border rounded-md p-2 w-full",value:e.almacenamiento_id,onChange:e=>{let t;return t=Number(e.target.value),I(R.map((e,i)=>i===a?{...e,almacenamiento_id:t}:e))},disabled:w,children:[(0,t.jsx)("option",{value:"",children:"Selecciona tipo almacenamiento"}),D.map(e=>(0,t.jsx)("option",{value:e.id,children:e.descripcion},e.id))]}),R.length>1&&(0,t.jsx)("button",{type:"button",onClick:()=>I(R.filter((e,t)=>t!==a)),className:"text-red-500 hover:underline",children:"Eliminar"})]},a))]}),(0,t.jsx)(o.motion.button,{type:"submit",whileTap:{scale:.97},className:"mt-6 bg-indigo-600 text-white rounded-md py-2 font-medium transition-colors hover:bg-indigo-700",children:"Guardar especificaciÃ³n"})]})]})}let f="http://localhost:5000";function x(){let[e,i]=(0,a.useState)(null),[n,r]=(0,a.useState)([]),[s,l]=(0,a.useState)(0);return(0,a.useEffect)(()=>{fetch("".concat(f,"/api/usuarios/me"),{credentials:"include"}).then(e=>{if(!e.ok)throw Error("No autenticado");return e.json()}).then(e=>i(e.user.id)).catch(()=>window.location.href="/login")},[]),(0,a.useEffect)(()=>{e&&fetch("".concat(f,"/api/comisiones/semana/").concat(e),{credentials:"include"}).then(e=>e.json()).then(e=>{r(e.filter(e=>null!==e.id));let t=e.find(e=>null!==e.total_semana);l(t?parseFloat(t.total_semana):0)})},[e]),(0,t.jsxs)(o.motion.div,{initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{type:"spring",stiffness:70,delay:.2},className:"bg-white rounded-xl shadow p-4 sm:p-6 w-full max-w-full",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Comisiones de la semana"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"p-4 bg-indigo-50 rounded-lg text-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"Total semana"}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-indigo-700 mt-1",children:["$",s.toLocaleString("es-MX",{minimumFractionDigits:2})]})]}),(0,t.jsxs)("div",{className:"p-4 bg-indigo-50 rounded-lg text-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"Equipos armados"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-indigo-700 mt-1",children:n.length})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"mb-2 text-gray-600 font-medium",children:"Detalle de equipos armados"}),(0,t.jsx)("ul",{className:"divide-y divide-gray-200 text-gray-700 mb-2",children:0===n.length?(0,t.jsx)("li",{className:"py-2 text-center text-gray-400",children:"No hay comisiones esta semana"}):n.map(e=>(0,t.jsxs)("li",{className:"py-2 flex justify-between",children:[(0,t.jsx)("span",{children:e.equipo_id?"Equipo #".concat(e.equipo_id):e.mantenimiento_id?"Mantenimiento #".concat(e.mantenimiento_id):"Sin referencia"}),(0,t.jsxs)("span",{children:["$",parseFloat(e.monto).toFixed(2)," |"," ",new Date(e.fecha_creacion).toLocaleDateString("es-MX")]})]},e.id))})]})]})}var g=e.i(37348);function b(){let[e,o]=(0,a.useState)("inventario"),n=(0,i.useRouter)();return(0,a.useEffect)(()=>{fetch("".concat("https://erp.pcmaker.mx","/api/usuarios/me"),{credentials:"include"}).then(e=>{if(!e.ok)throw Error("No autenticado");return e.json()}).then(e=>{var t;(null==(t=e.user)?void 0:t.rol_id)!==2&&n.push("/login")}).catch(()=>{n.push("/login")})},[n]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s,{active:e,setActive:o}),(0,t.jsxs)("main",{className:"flex-1 p-8 flex flex-col gap-6 overflow-auto lg:ml-24",children:["inventario"===e&&(0,t.jsx)(l.default,{}),"mantenimientos"===e&&(0,t.jsx)(u,{}),"historial"===e&&(0,t.jsx)(m,{}),"especificaciones"===e&&(0,t.jsx)(h,{}),"comisiones"===e&&(0,t.jsx)(x,{}),"lote"===e&&(0,t.jsx)(g.default,{})]})]})}},87083,e=>{e.v(t=>Promise.all(["static/chunks/cdb9f38e8c15eeaa.js"].map(t=>e.l(t))).then(()=>t(27169)))},97650,e=>{e.v(t=>Promise.all(["static/chunks/73b624621f3decf5.js"].map(t=>e.l(t))).then(()=>t(90557)))}]);