(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,a)=>{t.exports=e.r(76562)},83164,e=>{"use strict";e.s(["default",()=>j],83164),e.i(47167);var t=e.i(43476),a=e.i(71645),s=e.i(18566),r=e.i(46932),i=e.i(11152);let o=[{label:"Inventario",icon:(0,t.jsx)(i.FaBoxOpen,{}),path:"inventario"},{label:"Registrar venta",icon:(0,t.jsx)(i.FaShoppingCart,{}),path:"venta"},{label:"Reportes e historial",icon:(0,t.jsx)(i.FaFileAlt,{}),path:"reportes"},{label:"Comisiones",icon:(0,t.jsx)(i.FaDollarSign,{}),path:"comisiones"},{label:"Recibir lote",icon:(0,t.jsx)(i.FaTruck,{}),path:"lote"},{label:"Corte de caja",icon:(0,t.jsx)(i.FaCashRegister,{}),path:"caja"},{label:"Cerrar sesiÃ³n",icon:(0,t.jsx)(i.FaSignOutAlt,{}),path:"logout"}];function n(e){let{active:n,setActive:l}=e,[c,d]=(0,a.useState)(!1),[x,m]=(0,a.useState)(!1),u=(0,s.useRouter)();(0,a.useEffect)(()=>{let e=()=>m(window.innerWidth>=1024);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let p=async e=>{if("logout"===e){await fetch("".concat("https://erp.pcmaker.mx","/api/usuarios/logout"),{method:"POST",credentials:"include"}),localStorage.removeItem("email"),u.push("/login");return}l(e),d(!1)};return(0,t.jsxs)(t.Fragment,{children:[!x&&(0,t.jsx)("button",{className:"fixed top-5 left-5 z-40 bg-indigo-600 text-white p-2 rounded-full shadow lg:hidden",onClick:()=>d(!0),children:(0,t.jsx)(i.FaBars,{size:20})}),(0,t.jsxs)(r.motion.aside,{initial:!1,animate:{x:x||c?0:-140},transition:{type:"spring",stiffness:80,delay:.15},className:"\n          fixed top-0 left-0 z-30 h-full bg-white\n          border-r border-gray-200 shadow-sm py-4 px-4\n          flex flex-col\n          overflow-y-hidden\n          overflow-x-hidden\n          w-25\n          ".concat(c?"block":"hidden"," lg:flex\n        "),style:c&&!x?{boxShadow:"0 0 0 100vmax rgba(0,0,0,0.4)"}:{},children:[(0,t.jsx)("div",{className:"mb-8 flex justify-center",children:(0,t.jsx)("img",{src:"/pcmaker.png",alt:"Logo",className:"h-20 w-20 rounded-full shadow"})}),(0,t.jsx)("nav",{className:"flex-1 flex flex-col space-y-1 items-center",children:o.map(e=>(0,t.jsxs)(r.motion.button,{onClick:()=>p(e.path),whileHover:{scale:1.08},className:"flex flex-col items-center w-full py-3 rounded-xl text-xl px-2 transition-colors ".concat(n===e.path?"bg-indigo-50 text-indigo-600":"text-gray-400 hover:bg-gray-100 hover:text-indigo-600"),title:e.label,children:[(0,t.jsx)("div",{children:e.icon}),(0,t.jsx)("span",{className:"text-[11px] mt-1 font-medium",children:e.label})]},e.label))}),!x&&(0,t.jsx)("button",{className:"mt-8 bg-gray-200 text-gray-600 px-4 py-2 rounded lg:hidden",onClick:()=>d(!1),children:"Cerrar"})]}),c&&!x&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 z-20 lg:hidden",onClick:()=>d(!1)})]})}var l=e.i(32508),c=e.i(38325);function d(e){let{onClose:s,onSeleccionar:o}=e,[n,l]=(0,a.useState)([]),[d,x]=(0,a.useState)([]),[m,u]=(0,a.useState)([]),[p,h]=(0,a.useState)(!0),[g,f]=(0,a.useState)(null),b="https://erp.pcmaker.mx";(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat(b,"/api/usuarios/me"),{credentials:"include"});if(!e.ok)throw Error("No autenticado");let t=await e.json();f(t.user.sucursal_id)}catch(e){console.log("Error obteniendo sucursal:",e)}})()},[]);let j=async()=>{let e=await fetch("".concat(b,"/api/inventario?sucursal_id=").concat(g),{credentials:"include"});if(!e.ok)throw Error("Error inventario");return await e.json()},y=async()=>{let e=await fetch("".concat(b,"/api/inventario/equipos-armados?sucursal_id=").concat(g),{credentials:"include"});if(!e.ok)throw Error("Error equipos armados");return await e.json()};(0,a.useEffect)(()=>{g&&(async()=>{h(!0);try{let[e,t]=await Promise.all([j(),y()]);l(e),x(t)}catch(e){console.error("Error cargando inventario/equipos:",e),c.default.fire("Error","No se pudieron cargar los productos","error")}finally{h(!1)}})()},[g]);let N=e=>e.cantidad<=0?void c.default.fire({icon:"error",title:"Sin stock",text:'El producto "'.concat(e.descripcion,'" no tiene unidades disponibles.')}):!e.precio||e.precio<=0?void c.default.fire({icon:"warning",title:"Precio no asignado",text:"Asigna un precio al producto antes de usarlo."}):void u(t=>t.find(t=>t.id===e.id)?t.filter(t=>t.id!==e.id):[...t,{...e,cantidadSeleccionada:1}]),v=(e,t)=>{u(a=>a.map(a=>a.id===e?{...a,cantidadSeleccionada:Math.max(1,Math.min(t,a.cantidad))}:a))};if(p)return(0,t.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50",children:(0,t.jsx)("div",{className:"bg-white p-6 rounded-xl shadow-lg max-w-md w-full text-center text-gray-500",children:"Cargando productos..."})});let w=m.reduce((e,t)=>e+(Number(t.precio)||0)*t.cantidadSeleccionada,0);return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center z-50",children:(0,t.jsxs)(r.motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white p-6 rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] flex flex-col",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Seleccionar productos"}),(0,t.jsx)("h3",{className:"text-sm font-bold text-gray-600 mt-2 mb-1",children:"Inventario general"}),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 overflow-y-auto pr-2 max-h-[35vh]",children:n.map(e=>{let a=m.find(t=>t.id===e.id);return(0,t.jsxs)(r.motion.div,{whileHover:{scale:1.02},onClick:()=>N({id:e.id,tipo:e.tipo,descripcion:e.descripcion,especificacion:e.especificacion,cantidad:e.cantidad,estado:e.estado,precio:e.precio}),className:"cursor-pointer p-4 rounded-lg border transition-all flex flex-col items-start shadow-sm ".concat(a?"border-indigo-600 bg-indigo-50":"border-gray-100 bg-gray-50 hover:bg-gray-100"),children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[((e,a)=>{let s="".concat(e," ").concat(a||"").toLowerCase();return s.includes("ram")||s.includes("ddr")?(0,t.jsx)(i.FaMemory,{className:"text-indigo-600 text-3xl"}):s.includes("ssd")||s.includes("hdd")||s.includes("disco")?(0,t.jsx)(i.FaHdd,{className:"text-amber-600 text-3xl"}):s.includes("mouse")?(0,t.jsx)(i.FaMouse,{className:"text-blue-600 text-3xl"}):s.includes("teclado")?(0,t.jsx)(i.FaKeyboard,{className:"text-gray-700 text-3xl"}):s.includes("audifono")||s.includes("headset")?(0,t.jsx)(i.FaHeadphones,{className:"text-pink-600 text-3xl"}):s.includes("gamepad")||s.includes("control")?(0,t.jsx)(i.FaGamepad,{className:"text-purple-600 text-3xl"}):s.includes("usb")||s.includes("adaptador")?(0,t.jsx)(i.FaUsb,{className:"text-orange-600 text-3xl"}):s.includes("router")||s.includes("wifi")?(0,t.jsx)(i.FaWifi,{className:"text-green-600 text-3xl"}):s.includes("camara")?(0,t.jsx)(i.FaCamera,{className:"text-rose-600 text-3xl"}):s.includes("cable")||s.includes("hdmi")?(0,t.jsx)(i.FaTools,{className:"text-teal-600 text-3xl"}):s.includes("fuente")||s.includes("psu")?(0,t.jsx)(i.FaMicrochip,{className:"text-green-600 text-3xl"}):(0,t.jsx)(i.FaQuestionCircle,{className:"text-gray-400 text-3xl"})})(e.tipo,e.descripcion),(0,t.jsx)("span",{className:"font-semibold text-gray-800",children:e.descripcion})]}),(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:["Stock: ",e.cantidad]}),(0,t.jsxs)("span",{className:"text-sm text-gray-700",children:["ğŸ’²"," ",e.precio?Number(e.precio).toFixed(2):"Sin precio"]}),a&&(0,t.jsx)("input",{type:"number",min:1,max:e.cantidad,value:a.cantidadSeleccionada,onClick:e=>e.stopPropagation(),onChange:t=>v(e.id,parseInt(t.target.value)),className:"mt-3 w-full border rounded-md p-1 text-center text-sm"})]},e.id)})}),(0,t.jsx)("h3",{className:"text-sm font-bold text-gray-600 mt-4 mb-1",children:"Equipos armados"}),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 overflow-y-auto pr-2 max-h-[35vh]",children:d.map(e=>{let a=m.find(t=>t.id===e.id);return(0,t.jsxs)(r.motion.div,{whileHover:{scale:1.02},onClick:()=>N({id:e.id,tipo:"Equipo Armado",descripcion:e.nombre,especificacion:e.procesador,cantidad:e.cantidad,estado:e.estado,precio:e.precio}),className:"cursor-pointer p-4 rounded-lg border transition-all flex flex-col items-start shadow-sm ".concat(a?"border-indigo-600 bg-indigo-50":"border-gray-100 bg-gray-50 hover:bg-gray-100"),children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)(i.FaMicrochip,{className:"text-green-700 text-3xl"}),(0,t.jsx)("span",{className:"font-semibold text-gray-800",children:e.nombre})]}),(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:["Procesador: ",e.procesador]}),(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:["Stock: ",e.cantidad]}),(0,t.jsxs)("span",{className:"text-sm text-gray-700",children:["ğŸ’²"," ",e.precio?Number(e.precio).toFixed(2):"Sin precio"]}),(0,t.jsxs)("span",{className:"text-xs text-gray-500 mt-1",children:["RAM: ",e.memorias_ram.join(", ")]}),(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:["Almacenamiento: ",e.almacenamientos.join(", ")]}),a&&(0,t.jsx)("input",{type:"number",min:1,max:e.cantidad,value:a.cantidadSeleccionada,onClick:e=>e.stopPropagation(),onChange:t=>v(e.id,parseInt(t.target.value)),className:"mt-3 w-full border rounded-md p-1 text-center text-sm"})]},e.id)})}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,t.jsx)("button",{onClick:s,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700",children:"Cancelar"}),(0,t.jsx)("button",{disabled:0===m.length,onClick:()=>o(m),className:"px-4 py-2 rounded-lg shadow text-white ".concat(m.length>0?"bg-indigo-600 hover:bg-indigo-700":"bg-gray-400 cursor-not-allowed"),children:m.length>0?"Seleccionar (".concat(m.length,") - Total: $").concat(w.toFixed(2)):"Seleccionar (0)"})]})]})})}let x="https://erp.pcmaker.mx";function m(){let[e,s]=(0,a.useState)({cliente:"",observaciones:""}),[o,n]=(0,a.useState)([]),[l,m]=(0,a.useState)(!1),[u,p]=(0,a.useState)(null),[h,g]=(0,a.useState)(null),[f,b]=(0,a.useState)(!1),j=(0,a.useMemo)(()=>o.reduce((e,t)=>e+(Number(t.precio)||0)*(Number(t.cantidadSeleccionada)||0),0),[o]);(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat(x,"/api/usuarios/me"),{credentials:"include"});if(!e.ok)throw Error("No autenticado");let t=await e.json();p(t.user.id),g(t.user.sucursal_id)}catch(e){c.default.fire({icon:"warning",title:"SesiÃ³n expirada",text:"Debes iniciar sesiÃ³n nuevamente.",confirmButtonColor:"#4F46E5"}).then(()=>window.location.href="/login")}})()},[]);let y=e=>{let{name:t,value:a}=e.target;s(e=>({...e,[t]:a}))},N=async t=>{if(t.preventDefault(),!u||!h)return void c.default.fire({icon:"error",title:"Usuario no disponible",text:"Por favor, inicia sesiÃ³n nuevamente.",confirmButtonColor:"#4F46E5"});if(0===o.length)return void c.default.fire({icon:"info",title:"Selecciona productos",text:"Debes seleccionar al menos un producto antes de registrar la venta.",confirmButtonColor:"#4F46E5"});if(!e.cliente)return void c.default.fire({icon:"info",title:"Campo requerido",text:"Debes ingresar el nombre del cliente.",confirmButtonColor:"#4F46E5"});for(let e of o)if(e.cantidadSeleccionada>e.cantidad)return void c.default.fire({icon:"error",title:"Stock insuficiente",text:'No hay suficiente stock para "'.concat(e.descripcion,'".'),confirmButtonColor:"#4F46E5"});try{b(!0);let t=await fetch("".concat(x,"/api/ventas"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({cliente:e.cliente,observaciones:e.observaciones,usuario_id:u,sucursal_id:h,total:j,productos:o.map(e=>({id:e.id,cantidad:e.cantidadSeleccionada,precio_unitario:Number(e.precio)||0}))})});if(!t.ok){let e=await t.json();throw Error(e.message||"No se pudo registrar la venta.")}let a=await t.json(),r=a.id||a.venta_id,i=await fetch("".concat(x,"/api/caja/movimiento"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({tipo:"venta",monto:j,descripcion:"Venta #".concat(r," - Cliente: ").concat(e.cliente),usuario_id:u,sucursal_id:h,referencia_id:r})});if(!i.ok){let e=await i.json();throw Error(e.message||"Error al registrar movimiento en caja.")}let l=await fetch("".concat(x,"/api/inventario/descontar-venta"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({sucursal_id:h,productos:o.map(e=>({producto_id:e.id,cantidad_vendida:e.cantidadSeleccionada}))})});if(!l.ok){let e=await l.json();throw Error(e.message||"Error al descontar stock.")}await c.default.fire({icon:"success",title:"Venta registrada",text:"La venta, el movimiento de caja y el descuento de inventario se realizaron correctamente.",showConfirmButton:!1,timer:3e3}),s({cliente:"",observaciones:""}),n([])}catch(e){c.default.fire({icon:"error",title:"Error al registrar",text:e.message||"OcurriÃ³ un error durante el registro.",confirmButtonColor:"#4F46E5"})}finally{b(!1)}};return(0,t.jsxs)(r.motion.div,{initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{type:"spring",stiffness:70},className:"bg-white rounded-xl shadow p-6 max-w-xl",children:[(0,t.jsxs)("h2",{className:"text-lg font-semibold mb-4 text-gray-700 flex items-center gap-2",children:[(0,t.jsx)(i.FaShoppingCart,{className:"text-indigo-600"})," Registrar venta"]}),(0,t.jsxs)("form",{onSubmit:N,className:"flex flex-col gap-4",children:[(0,t.jsx)("input",{type:"text",name:"cliente",placeholder:"Nombre cliente",value:e.cliente,onChange:y,className:"border rounded-md p-2 text-gray-600"}),(0,t.jsx)("button",{type:"button",onClick:()=>m(!0),className:"bg-indigo-100 border border-indigo-300 rounded-md p-2 text-indigo-700 hover:bg-indigo-200 transition",children:o.length>0?"ğŸ”„ Editar productos seleccionados":"â• Seleccionar productos"}),o.length>0&&(0,t.jsxs)("div",{className:"border rounded-md p-3 bg-gray-50",children:[(0,t.jsx)("h4",{className:"font-semibold text-gray-700 mb-2",children:"Productos seleccionados"}),(0,t.jsx)("ul",{className:"space-y-2",children:o.map(e=>(0,t.jsxs)("li",{className:"flex justify-between items-center text-sm text-gray-700 bg-white p-2 rounded-md border",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e.descripcion||e.especificacion}),(0,t.jsxs)("p",{className:"text-gray-500",children:[e.cantidadSeleccionada," unidades Ã— $",Number(e.precio||0).toFixed(2)]}),(0,t.jsxs)("p",{className:"text-gray-600 font-semibold",children:["Subtotal: $",(Number(e.precio||0)*Number(e.cantidadSeleccionada)).toFixed(2)," MXN"]})]}),(0,t.jsx)("button",{type:"button",onClick:()=>{var t;return t=e.id,void n(e=>e.filter(e=>e.id!==t))},className:"text-red-500 hover:text-red-700 text-xs font-semibold",children:"âœ–"})]},e.id))}),(0,t.jsxs)("div",{className:"text-right mt-3 font-bold text-gray-800",children:["Total: $",j.toFixed(2)," MXN"]})]}),(0,t.jsx)("textarea",{name:"observaciones",placeholder:"Observaciones (opcional)",value:e.observaciones,onChange:y,rows:3,className:"border rounded-md p-2 text-gray-600 resize-none"}),(0,t.jsx)("button",{type:"submit",className:"w-full text-white font-medium py-2.5 rounded-lg transition ".concat(f?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"),disabled:f,children:f?(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,t.jsxs)("svg",{className:"w-5 h-5 animate-spin text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),"Procesando..."]}):"Registrar venta"})]}),l&&(0,t.jsx)(d,{onClose:()=>m(!1),onSeleccionar:e=>{n(e),m(!1)}})]})}let u=[{cliente:"Juan PÃ©rez",producto:"Laptop HP 245 G7",fecha:"2025-09-12"},{cliente:"MarÃ­a LÃ³pez",producto:"Cargador 65W",fecha:"2025-09-13"}];function p(){return(0,t.jsxs)(r.motion.div,{initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{type:"spring",stiffness:70},className:"bg-white rounded-xl shadow p-6 max-w-4xl",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Reportes e historial de clientes"}),(0,t.jsxs)("table",{className:"w-full table-auto",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"text-left p-2 text-xs font-medium text-gray-500",children:"Cliente"}),(0,t.jsx)("th",{className:"text-left p-2 text-xs font-medium text-gray-500",children:"Producto"}),(0,t.jsx)("th",{className:"text-left p-2 text-xs font-medium text-gray-500",children:"Fecha"})]})}),(0,t.jsx)("tbody",{children:u.map((e,a)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"p-2",children:e.cliente}),(0,t.jsx)("td",{className:"p-2",children:e.producto}),(0,t.jsx)("td",{className:"p-2",children:e.fecha})]},a))})]})]})}function h(){return(0,t.jsxs)(r.motion.div,{initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{type:"spring",stiffness:70,delay:.2},className:"bg-white rounded-xl shadow p-4 sm:p-6 w-full max-w-full",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Comisiones acumuladas"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"p-4 bg-indigo-50 rounded-lg text-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"Total acumulado"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-indigo-700 mt-1",children:"$3,250.00"})]}),(0,t.jsxs)("div",{className:"p-4 bg-indigo-50 rounded-lg text-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"Equipos entregados"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-indigo-700 mt-1",children:"14"})]})]}),(0,t.jsx)(r.motion.div,{className:"h-32 flex items-center justify-center mt-6",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.6,duration:.4},children:(0,t.jsxs)("svg",{width:"80",height:"80",viewBox:"0 0 80 80",children:[(0,t.jsx)("circle",{cx:"40",cy:"40",r:"30",stroke:"#6366f1",strokeWidth:"10",fill:"none",opacity:.2}),(0,t.jsx)("circle",{cx:"40",cy:"40",r:"30",stroke:"#6366f1",strokeWidth:"10",fill:"none",strokeDasharray:"188",strokeDashoffset:"94",style:{transition:"stroke-dashoffset .8s cubic-bezier(.4,1,.2,1)"}})]})}),(0,t.jsx)("div",{className:"text-center text-xs mt-2 text-gray-400",children:"GrÃ¡fica de comisiones (ejemplo)"})]})}var g=e.i(37348);let f="https://erp.pcmaker.mx";function b(){let[e,r]=(0,a.useState)(null),[o,n]=(0,a.useState)(null),[l,d]=(0,a.useState)(0),[x,m]=(0,a.useState)(0),[u,p]=(0,a.useState)(0),[h,g]=(0,a.useState)([]),[b,j]=(0,a.useState)("gasto"),[y,N]=(0,a.useState)(""),[v,w]=(0,a.useState)(""),C=(0,s.useRouter)(),S=l+u-x;(0,a.useEffect)(()=>{fetch("".concat(f,"/api/usuarios/me"),{credentials:"include"}).then(e=>{if(!e.ok)throw Error("No autenticado");return e.json()}).then(e=>{r(e.user.id),n(e.user.sucursal_id),F(e.user.sucursal_id),_(e.user.sucursal_id)}).catch(()=>C.push("/login"))},[C]);let F=async e=>{try{let e=await fetch("".concat(f,"/api/caja/resumen"),{credentials:"include"});if(!e.ok)return;let t=await e.json();d(Number(t.total_ventas)||0),m(Number(t.total_gastos)||0),p(Number(t.total_ingresos)||0)}catch(e){console.error("Error cargando resumen de caja:",e)}},k=async()=>{if(!y||!b||!e||!o)return void c.default.fire({icon:"warning",title:"Datos incompletos",text:"Por favor completa todos los campos antes de registrar el movimiento.",confirmButtonColor:"#4F46E5"});try{(await fetch("".concat(f,"/api/caja/movimiento"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({tipo:b,monto:parseFloat(y),descripcion:v,sucursal_id:o,usuario_id:e})})).ok?(c.default.fire({icon:"success",title:"Movimiento registrado",text:"El movimiento fue guardado correctamente.",confirmButtonColor:"#4F46E5"}),N(""),w(""),F(o),_(o)):c.default.fire({icon:"error",title:"Error al registrar",text:"Hubo un problema al registrar el movimiento.",confirmButtonColor:"#4F46E5"})}catch(e){console.error("Error registrando movimiento:",e),c.default.fire({icon:"error",title:"Error inesperado",text:"No se pudo registrar el movimiento.",confirmButtonColor:"#4F46E5"})}},E=async()=>{if((await c.default.fire({title:"Â¿Generar corte de caja?",text:"Esto cerrarÃ¡ el balance actual y registrarÃ¡ un nuevo corte.",icon:"question",showCancelButton:!0,confirmButtonColor:"#16A34A",cancelButtonColor:"#DC2626",confirmButtonText:"SÃ­, generar corte"})).isConfirmed)try{(await fetch("".concat(f,"/api/caja/corte"),{method:"POST",credentials:"include"})).ok?(c.default.fire({icon:"success",title:"Corte generado",text:"El corte de caja se generÃ³ correctamente.",confirmButtonColor:"#16A34A"}),_(o)):c.default.fire({icon:"error",title:"Error",text:"No se pudo generar el corte de caja.",confirmButtonColor:"#4F46E5"})}catch(e){console.error("Error generando corte de caja:",e),c.default.fire({icon:"error",title:"Error inesperado",text:"Hubo un problema al generar el corte de caja.",confirmButtonColor:"#4F46E5"})}},_=async e=>{try{let e=await fetch("".concat(f,"/api/caja/cortes"),{credentials:"include"});if(!e.ok)return;let t=await e.json();g(t)}catch(e){console.error("Error al cargar cortes:",e)}};return(0,t.jsxs)("div",{className:"p-6 bg-white rounded-xl shadow-md max-w-6xl mx-auto",children:[(0,t.jsxs)("h2",{className:"text-2xl font-bold mb-6 text-gray-800 flex items-center gap-3",children:[(0,t.jsx)(i.FaFileInvoiceDollar,{className:"text-indigo-600"})," Corte de Caja"]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[(0,t.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-xl shadow-sm flex flex-col items-start",children:[(0,t.jsx)(i.FaShoppingCart,{className:"text-green-600 text-3xl mb-2"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm",children:"Total Ventas"}),(0,t.jsxs)("h3",{className:"text-2xl font-semibold text-green-700",children:["$",l.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl shadow-sm flex flex-col items-start",children:[(0,t.jsx)(i.FaArrowDown,{className:"text-red-600 text-3xl mb-2"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm",children:"Total Gastos"}),(0,t.jsxs)("h3",{className:"text-2xl font-semibold text-red-700",children:["$",x.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl shadow-sm flex flex-col items-start",children:[(0,t.jsx)(i.FaArrowUp,{className:"text-blue-600 text-3xl mb-2"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm",children:"Ingresos Extra"}),(0,t.jsxs)("h3",{className:"text-2xl font-semibold text-blue-700",children:["$",u.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-xl shadow-sm flex flex-col items-start",children:[(0,t.jsx)(i.FaBalanceScale,{className:"text-3xl mb-2 ".concat(S>=0?"text-green-700":"text-red-700")}),(0,t.jsx)("p",{className:"text-gray-600 text-sm",children:"Balance Final"}),(0,t.jsxs)("h3",{className:"text-2xl font-bold ".concat(S>=0?"text-green-700":"text-red-700"),children:["$",S.toFixed(2)]})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-5 mb-8",children:[(0,t.jsxs)("h3",{className:"font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[(0,t.jsx)(i.FaPlus,{className:"text-indigo-600"})," Registrar movimiento"]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("select",{className:"border rounded-lg px-3 py-2",value:b,onChange:e=>j(e.target.value),children:[(0,t.jsx)("option",{value:"gasto",children:"Gasto"}),(0,t.jsx)("option",{value:"ingreso",children:"Ingreso"}),(0,t.jsx)("option",{value:"venta",children:"Venta manual"})]}),(0,t.jsx)("input",{type:"number",placeholder:"Monto",className:"border rounded-lg px-3 py-2",value:y,onChange:e=>N(e.target.value)}),(0,t.jsx)("input",{type:"text",placeholder:"DescripciÃ³n",className:"border rounded-lg px-3 py-2",value:v,onChange:e=>w(e.target.value)}),(0,t.jsx)("button",{onClick:k,className:"bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 rounded-lg transition",children:"Registrar"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[(0,t.jsx)(i.FaListUl,{className:"text-indigo-600"})," Historial de cortes"]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full border border-gray-200 rounded-lg",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-gray-100 text-gray-700",children:[(0,t.jsx)("th",{className:"py-2 px-4 text-left",children:"Fecha"}),(0,t.jsx)("th",{className:"py-2 px-4 text-left",children:"Ventas"}),(0,t.jsx)("th",{className:"py-2 px-4 text-left",children:"Gastos"}),(0,t.jsx)("th",{className:"py-2 px-4 text-left",children:"Ingresos"}),(0,t.jsx)("th",{className:"py-2 px-4 text-left",children:"Balance"})]})}),(0,t.jsxs)("tbody",{children:[0===h.length&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:5,className:"text-center py-3 text-gray-500",children:"No hay cortes registrados"})}),h.map((e,a)=>(0,t.jsxs)("tr",{className:"border-t hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"py-2 px-4",children:new Date(e.fecha).toLocaleDateString()}),(0,t.jsxs)("td",{className:"py-2 px-4 text-green-700",children:["$",e.total_ventas]}),(0,t.jsxs)("td",{className:"py-2 px-4 text-red-700",children:["$",e.total_gastos]}),(0,t.jsxs)("td",{className:"py-2 px-4 text-blue-700",children:["$",e.total_ingresos]}),(0,t.jsxs)("td",{className:"py-2 px-4 font-semibold ".concat(e.balance_final>=0?"text-green-700":"text-red-700"),children:["$",e.balance_final]})]},a))]})]})})]}),(0,t.jsxs)("button",{onClick:E,className:"flex items-center justify-center gap-2 bg-green-600 hover:bg-green-700 text-white font-semibold py-3 w-full rounded-xl shadow transition mt-8",children:[(0,t.jsx)(i.FaMoneyBillWave,{})," Generar Corte de Caja"]})]})}function j(){let[e,r]=(0,a.useState)("inventario"),i=(0,s.useRouter)();return(0,a.useEffect)(()=>{fetch("".concat("https://erp.pcmaker.mx","/api/usuarios/me"),{credentials:"include"}).then(e=>{if(!e.ok)throw Error("No autenticado");return e.json()}).then(e=>{var t;(null==(t=e.user)?void 0:t.rol_id)!==3&&i.push("/login")}).catch(()=>{i.push("/login")})},[i]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n,{active:e,setActive:r}),(0,t.jsxs)("main",{className:"flex-1 p-8 flex flex-col gap-6 overflow-auto lg:ml-24",children:["inventario"===e&&(0,t.jsx)(l.default,{}),"venta"===e&&(0,t.jsx)(m,{}),"reportes"===e&&(0,t.jsx)(p,{}),"comisiones"===e&&(0,t.jsx)(h,{}),"lote"===e&&(0,t.jsx)(g.default,{}),"caja"===e&&(0,t.jsx)(b,{})]})]})}},87083,e=>{e.v(t=>Promise.all(["static/chunks/cdb9f38e8c15eeaa.js"].map(t=>e.l(t))).then(()=>t(27169)))},97650,e=>{e.v(t=>Promise.all(["static/chunks/73b624621f3decf5.js"].map(t=>e.l(t))).then(()=>t(90557)))}]);